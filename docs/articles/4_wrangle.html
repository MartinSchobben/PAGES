<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>4. Wrangling • PAGES</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="4. Wrangling">
<meta property="og:description" content="PAGES">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PAGES</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">Exercises</li>
    <li>
      <a href="../articles/1_project.html">1. Data (geo)science project</a>
    </li>
    <li>
      <a href="../articles/2_explore.html">2. Exploratory data analysis</a>
    </li>
    <li>
      <a href="../articles/3_model.html">3. Patterns and models</a>
    </li>
    <li>
      <a href="../articles/4_wrangle.html">4. Wrangling</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="4_wrangle_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>4. Wrangling</h1>
            
      
      
      <div class="hidden name"><code>4_wrangle.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">PAGES</span><span class="op">)</span></code></pre></div>
<div id="tidyverse-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#tidyverse-packages" class="anchor"></a>Tidyverse packages</h1>
<p>In this last exercise I show some functionality of the <code>tidyr</code> <span class="citation">(Wickham 2021)</span> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></code></pre></div>
<p>From the website:</p>
<p>"The goal of tidyr is to help you create tidy data. Tidy data is data where:</p>
<ul>
<li>Every column is variable.</li>
<li>Every row is an observation.</li>
<li>Every cell is a single value.</li>
</ul>
<p>Tidy data describes a standard way of storing data that is used wherever possible throughout the tidyverse."</p>
<p>This looks like this:</p>
<div class="figure">
<img src="figures/tidy.png" alt="obs = observation, var = variable and val = value" width="70%"><p class="caption">
obs = observation, var = variable and val = value
</p>
</div>
<div id="kuhjoch-wide-format" class="section level2">
<h2 class="hasAnchor">
<a href="#kuhjoch-wide-format" class="anchor"></a>Kuhjoch wide format</h2>
<p>The following format of the data frame (or <code>tibble</code> <span class="citation">(Müller and Wickham 2021)</span> in the tidyverse universe) is a format that we are used to see in publications. Here count data of all different elements each occupy their own column (i.e., variable).</p>
<pre><code>#&gt; # A tibble: 6 x 5
#&gt;   Height landplant_pollen landplant_spores environment_aquat… environment_terre…
#&gt;    &lt;dbl&gt;            &lt;int&gt;            &lt;int&gt;              &lt;int&gt;              &lt;int&gt;
#&gt; 1   1600               31              277                 65                308
#&gt; 2   1365               27              262                114                289
#&gt; 3   1125               22              282                 40                304
#&gt; 4   1045               24              276                 44                300
#&gt; 5    965               29              276                 75                305
#&gt; 6    885               19              284                 70                303</code></pre>
<p>However, we can also describe this data in a long format, as the class of the values in the cells for the palynomorphs are all the same (i.e., they are all integer count data). So, how can we make a long format data frame out of this?</p>
</div>
<div id="kuhjoch-long-format" class="section level2">
<h2 class="hasAnchor">
<a href="#kuhjoch-long-format" class="anchor"></a>Kuhjoch long format</h2>
<p>For such operations, we can use the <code>tidyr</code> <span class="citation">(Wickham 2021)</span> function <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>.</p>
<p><img src="figures/pivot.png" width="70%"></p>
<p>However, the question is a bit of trick question, as the variable names also contains information. Actually, there are additional variables stashed in the column names. In this case, the word in the variable name before the subscript <code>_</code> is another categorical variable dividing the the <code>label</code> in two subsets; <code>"landplant"</code>; denoting whether the variable <code>label</code> describes a characteristic of land plant community composition (either pollen or spores), and <code>"environment"</code>; denoting whether the variable <code>label</code> describes a characteristic of the environment (i.e., is the palynomorph an aquatic or terrestrial component?).</p>
<p>To achieve the previous describe transformation to a long format data frame, and the extraction of the information in the column names, we construct the following call.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># long format</span>
<span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="va">kuhjoch</span>, 
  cols <span class="op">=</span> <span class="op">-</span><span class="va">Height</span>,  
  names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"type"</span>, <span class="st">"label"</span><span class="op">)</span>,
  values_to <span class="op">=</span> <span class="st">"count"</span>,
  names_sep <span class="op">=</span> <span class="st">"_"</span>
  <span class="op">)</span>
<span class="co">#&gt; # A tibble: 180 x 4</span>
<span class="co">#&gt;    Height type        label       count</span>
<span class="co">#&gt;     &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;int&gt;</span>
<span class="co">#&gt;  1   1600 landplant   pollen         31</span>
<span class="co">#&gt;  2   1600 landplant   spores        277</span>
<span class="co">#&gt;  3   1600 environment aquatic        65</span>
<span class="co">#&gt;  4   1600 environment terrestrial   308</span>
<span class="co">#&gt;  5   1365 landplant   pollen         27</span>
<span class="co">#&gt;  6   1365 landplant   spores        262</span>
<span class="co">#&gt;  7   1365 environment aquatic       114</span>
<span class="co">#&gt;  8   1365 environment terrestrial   289</span>
<span class="co">#&gt;  9   1125 landplant   pollen         22</span>
<span class="co">#&gt; 10   1125 landplant   spores        282</span>
<span class="co">#&gt; # … with 170 more rows</span></code></pre></div>
<p>Note that in this call we select column with <code>-Height</code>, so we take everything except the height variable. Also note that the vector of two elements for the <code>names_to</code> argument defines the two new categorical columns and <code>name_sep</code> controls how the original column names are split (<code>"_"</code>).</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-tibble" class="csl-entry">
Müller, Kirill, and Hadley Wickham. 2021. <em>Tibble: Simple Data Frames</em>. <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a>.
</div>
<div id="ref-tidyr" class="csl-entry">
Wickham, Hadley. 2021. <em>Tidyr: Tidy Messy Data</em>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Martin Schobben.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
